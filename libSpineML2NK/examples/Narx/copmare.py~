import scipy.io as io
import h5py
from matplotlib import pyplot as plt
import numpy as np

# Input Differences
mutant = io.loadmat('data/MutantBG6Data.mat')
nk_input = h5py.File('RealInput_I.h5')['array'][:]
m_input = mutant['recorded_input'][4000:4000+len(nk_input)]

ax = plt.subplot(2, 1, 1)
plt.title('inputs')
plt.plot(nk_input, label='Neurokernel')
plt.plot(m_input, label='Mutant')
plt.legend()
ax = plt.subplot(2, 1, 2)
plt.title('difference')
plt.plot(m_input-nk_input,label='Difference')
plt.legend()
plt.show()

# Output differences
m_output = mutant['MPO_Blocks'][4000:4000+len(nk_input)] - np.mean( mutant['MPO_Blocks'][4000:4000+len(nk_input)])
nk_output = h5py.File('RealInput_y.h5')['array'][:] - np.mean(h5py.File('RealInput_y.h5')['array'][:])

ax = plt.subplot(2, 1, 1)
ax.set_ylim([-100,100])

plt.title('Narx Output')
plt.plot(nk_output, label='Neurokernel')
plt.plot(m_output, label='Mutant')
plt.legend()

ax = plt.subplot(2, 1, 2)
plt.title('difference')
plt.plot(m_output-nk_output)
plt.legend()
plt.show()

print "Difference %s" % np.mean(m_output-nk_output)

# Gain Differences
nk_mean_g = h5py.File('RealInput_mean_g.h5')['array'][:]
m_mean_g =  mutant['Blocks_MeanGain'][4000:4000+len(nk_input)]

nk_contrast_g = h5py.File('RealInput_contrast_g.h5')['array'][:]
m_contrast_g =  mutant['Blocks_ContrastGain'][4000:4000+len(nk_input)]

ax = plt.subplot(2, 1, 1)
plt.title('Total Mean Gain')
plt.plot(nk_mean_g, label='Neurokernel')
plt.plot(m_mean_g, label='Mutant')
plt.legend()
ax = plt.subplot(2, 1, 2)
plt.title('Total Contrast Gain')
plt.plot(nk_contrast_g, label='Neurokernel')
plt.plot(m_contrast_g, label='Mutant')
plt.legend()
plt.show()

# Computed Means
nk_mean = h5py.File('RealInput_mu_m.h5')['array'][:]
m_mean =  mutant['Computed_Mean'][4000:4000+len(nk_input)]

nk_contrast = h5py.File('RealInput_mu_c.h5')['array'][:]
m_contrast =  mutant['Computed_Contrast'][4000:4000+len(nk_input)]

ax = plt.subplot(2, 1, 1)
plt.title('Computed Mean')
plt.plot(nk_mean, label='Neurokernel')
plt.plot(m_mean, label='Mutant')
plt.legend()
ax = plt.subplot(2, 1, 2)
plt.title('Computed Contrast')
plt.plot(nk_contrast, label='Neurokernel')
plt.plot(m_contrast, label='Mutant')
plt.legend()
plt.show()

























